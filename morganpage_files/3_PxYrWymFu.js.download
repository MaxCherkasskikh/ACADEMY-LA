if (self.CavalryLogger) { CavalryLogger.start_js(["ugVsk"]); }

__d("MFeedShareAnalytics",["ShareAudience","ShareModeConst","ShareMenuEventShareType","ShareMenuTypedLogger","ShareSignificance","Stratcom"],(function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";__p&&__p();var m="feed_share_action";a={_listeners:[],_initShareMode:null,_currentShareMode:null,_entryPointFromShareMode:function(a){switch(a){case h.FRIEND:return"share_to_friend_timeline";case h.GROUP:return"share_to_group";case h.MESSAGE:return"send_in_message";case h.ONE_CLICK:return"share_now";case h.OWN_POST:case h.SELF_POST:return"write_post";case h.PAGE:case h.SELF_PAGE:return"page";default:return"unknown"}},init:function(){this._cleanupListeners(),this._registerListeners(),this._initShareMode=null,this._currentShareMode=null},_onTearDown:function(){this._currentShareMode&&this.onShareAbandoned()},_registerListeners:function(){this._listeners.push(l.listen("m:sharemode:selected",null,function(a){a=a.getData();a&&a.sharemode&&(this._currentShareMode=a.sharemode)}.bind(this))),this._listeners.push(l.listen("m:page:unload",null,function(){this._onTearDown()}.bind(this)))},_cleanupListeners:function(){this._onTearDown();while(this._listeners.length>0){var a=this._listeners.pop();a&&a.remove&&a.remove()}},onMenuOpened:function(){this._initShareMode=null,this._currentShareMode=null,new j().setName(m).setShareType(i.SHARE_FLOW_STARTED).log()},onMenuOptionSelected:function(a){this._initShareMode=a;this._currentShareMode=a;a=this._entryPointFromShareMode(a);new j().setName(m).setShareType(i.SHARE_OPTION_SELECTED).setEntryPoint(a).log()},_getShareTextArea:function(){var a=document.getElementById("share_msg_input");return a instanceof HTMLTextAreaElement?a:null},_getAudienceFromCurrentState:function(){__p&&__p();var a=document.getElementsByName("privacyx")[1];if(!a||!(a instanceof HTMLInputElement))return g.UNKNOWN;switch(this._currentShareMode){case h.FRIEND:return g.FRIEND_TIMELINE;case h.GROUP:return g.GROUP;case h.MESSAGE:return g.MESSENGER;case h.PAGE:case h.SELF_PAGE:return g.PAGE;case h.SELF_POST:case h.OWN_POST:return g.fromPrivacyString(a.value);default:return h.UNKNOWN}},onShareAbandoned:function(){__p&&__p();var a=null,b=null,c=null;if(this._initShareMode){a=this._entryPointFromShareMode(this._initShareMode);var d=this._getShareTextArea();d&&(b=k.calculate(d.value));c=this._getAudienceFromCurrentState()}new j().setName(m).setShareType(i.SHARE_ABANDONED).setEntryPoint(a).setAudience(c).setSignificance(b).log();this._initShareMode=null;this._currentShareMode=null}};e.exports=a}),null);