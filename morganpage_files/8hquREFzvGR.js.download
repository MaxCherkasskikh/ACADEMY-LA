if (self.CavalryLogger) { CavalryLogger.start_js(["\/w0Op"]); }

__d("MInitJewelCounts",["Stratcom"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=[],i=!1;function j(a){g.invoke("m:jewels:init-counts",null,a)}function a(a){j(a),i||h.push(a)}function b(){if(i)return;i=!0;var a=h.splice(0,h.length);a.forEach(function(a){j(a)})}e.exports={main:a,replayMissedEvents:b}}),null);
__d("Popover",["setTimeoutAcrossTransitions","CSS","DOM","MAria","MViewport","Stratcom","Vector","$","eventsMixinDeprecated"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){__p&&__p();var p=40;function q(a){"use strict";__p&&__p();var b=a.flyout;this.flyout=typeof b=="string"?n(b):b;this.content=i.scry(this.flyout,"div","flyout-content")[0];this.options=a;this._onOrientationChange=this._reposition.bind(this);this.jewelRedirect=a.jewelRedirect;h.conditionClass(this.flyout,"popover_flyout",!0);b=a.button;b&&(this.button=typeof b=="string"?n(b):b,this.buttonClickListener=i.listen(this.button,"click",null,this._openHandler.bind(this)),this.button.setAttribute("role","button"),j.setupPopup(this.button,this.flyout));b=a.flyoutAnchor;b?this.flyoutAnchor=typeof b=="string"?n(b):b:this.flyoutAnchor=this.button;this.options.flyoutFromRoot&&(this.flyoutClickListener=i.listen(this.flyout,"click",null,this._openHandler.bind(this)));this.options.touchstart_callback&&(this.flyoutTouchStartListener=i.listen(this.flyout,"touchstart",null,this._touchStartHandler.bind(this)));this.options.touchmove_callback&&(this.flyoutTouchMoveListener=i.listen(this.flyout,"touchmove",null,this._touchMoveHandler.bind(this)));this.options.touchend_callback&&(this.flyoutTouchEndListener=i.listen(this.flyout,"touchend",null,this._touchEndHandler.bind(this)));q._instances[this.flyout.id]=this}q.prototype.isOpen=function(){"use strict";return!!this._isOpen};q.prototype.open=function(){"use strict";__p&&__p();if(this.isOpen())return;q._activePopover&&q._activePopover.close();q._activePopover=this;this._isOpen=!0;this.constraint=null;this.jewelRedirect||h.conditionClass(this.flyout,"popover_hidden",!1);this.options.flyoutFromRoot&&this._absolutePositionFlyout();this._position();this.options.heightConstraint||(h.conditionClass(document.body,"disableClicks",!0),this.globalListener=l.listenCapture("click",null,this._closeHandler.bind(this)));window.addEventListener("orientationchange",this._onOrientationChange,!1);j.showPopup(this.button,this.flyout);if(this.options.ensureVisible){var a=k.getScrollTop(),b=this._getElementPosition(this.flyout).y,c=b+this.flyout.offsetHeight;c=c-(a+k.getUseableHeight());if(c>0){c=Math.min(c,Math.max(b-a-p,0));k.scrollTo(0,a+c)}}this.invoke("open")};q.prototype.close=function(a){"use strict";__p&&__p();if(!this.isOpen())return;q._activePopover=null;this._isOpen=!1;h.conditionClass(this.flyout,"popover_hidden",!0);this.options.flyoutFromRoot&&(this.flyoutParent.appendChild(this.flyout),delete this.flyoutParent);g(function(){h.conditionClass(document.body,"disableClicks",!1)}.bind(this),400);this.globalListener&&this.globalListener.remove();window.removeEventListener("orientationchange",this._onOrientationChange,!1);this._releaseConstraint();j.hidePopup(this.button,this.flyout);a||this.invoke("close")};q.prototype.clear=function(){"use strict";this.globalListener&&this.globalListener.remove(),this.buttonClickListener&&this.buttonClickListener.remove(),this.flyoutClickListener&&this.flyoutClickListener.remove(),this.flyoutTouchStartListener&&this.flyoutTouchStartListener.remove(),this.flyoutTouchMoveListener&&this.flyoutTouchMoveListener.remove(),this.flyoutTouchEndListener&&this.flyoutTouchEndListener.remove(),delete q._instances[this.flyout.id]};q.prototype.refreshConstraints=function(){"use strict";if(!this._isOpen||this.jewelRedirect)return!1;var a=this.flyout;this._releaseConstraint();this.options.heightConstraint?(a.style.minHeight=k.getUseableHeight()+"px",this.constraint=k.addHeightConstraint(m.getDim(this.content).y+this._getElementPosition(a).y)):this.constraint=k.addMinHeightConstraint(m.getDim(a).y+this._getElementPosition(a).y+q._MARGIN)};q.prototype._getTouchPoint=function(event){"use strict";var a=event.getRawEvent().targetTouches[0];a={x:a?a.screenX:0,y:a?a.screenY:0};return a};q.prototype._touchStartHandler=function(event){"use strict";this.options.touchstart_callback(this._getTouchPoint(event))};q.prototype._touchMoveHandler=function(event){"use strict";this.isOpen()&&this.options.touchmove_callback(this._getTouchPoint(event))};q.prototype._touchEndHandler=function(event){"use strict";this.options.touchend_callback(this._getTouchPoint(event))};q.prototype._openHandler=function(event){"use strict";__p&&__p();this.jewelRedirect||event.prevent();var a=this.isOpen();if(a&&!this.options.preventClose)this.close();else if(!a){a=i.scry(document,"input");for(var b=0;b<a.length;b++)a[b].blur();this.open()}};q.prototype._closeHandler=function(event){"use strict";event.getNode("popover")||this.close()};q.prototype._getElementPosition=function(a){"use strict";__p&&__p();var b=a.offsetLeft,c=a.offsetTop;a=a.offsetParent;while(a&&a!==document.documentElement){b+=a.offsetLeft;c+=a.offsetTop;var d=window.getComputedStyle(a);b+=parseInt(d.getPropertyValue("border-left-width").slice(0,-2),10);c+=parseInt(d.getPropertyValue("border-top-width").slice(0,-2),10);a=a.offsetParent}return new m(b,c)};q.prototype._absolutePositionFlyout=function(){"use strict";this.flyoutParent=this.flyout.parentNode;n("root").appendChild(this.flyout);var a=this._getElementPosition(this.flyout.parentNode),b=this._getElementPosition(this.flyoutAnchor),c=m.getDim(this.flyoutAnchor);b=b.y-a.y+c.y;this.flyout.style.position="absolute";this.flyout.style.top=b+"px"};q.prototype._position=function(){"use strict";var a=this.flyout;if(this.flyoutAnchor&&this.options.positionNub){var b=this._getElementPosition(this.flyoutAnchor),c=i.find(this.flyout,"*","nub"),d=m.getDim(c).x,e=m.getDim(this.flyoutAnchor).x;a=this._getElementPosition(a);new m(b.x-a.x+(e-d)/2,0).setPos(c)}this.refreshConstraints()};q.prototype._reposition=function(){"use strict";g(this._position.bind(this),0)};q.prototype._releaseConstraint=function(){"use strict";this.constraint&&(this.constraint.release(),this.constraint=null)};q.getInstance=function(a){"use strict";return q._instances[a]};q.clearAll=function(){"use strict";for(var a=0;a<q._instances.length;a++)q._instances[a].clear()};o(q,["open","close"]);Object.assign(q,{_activePopover:null,_MARGIN:40,_instances:{}});e.exports=q}),null);
__d("MJewel",["CSS","DOM","MHistory","MJSEnvironment","MLogState","MTabbable","MViewport","Popover","Stratcom","URI","$","eventsMixinDeprecated","intlNumUtils","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){__p&&__p();var u="/friends/center/requests/";function v(a,b){"use strict";this._sigil=a,this.options=b||{},this._jewelNode=q(v.JEWEL_NAV_NODE_ID),this._softState=b.softState||"jewel="+v.nextID++,this._duringInit=!1,this.jewelRedirect=b.jewelRedirect,this._createPopover(),o.listen("m:history:change",null,this._updateJewelsOnHistoryChange.bind(this))}v.prototype._updateJewelsOnHistoryChange=function(event){"use strict";var a=new p(event.getData().path);a=a.getPath();a=this.jewelRedirect&&this.isOpen()&&!event.getData().soft&&a===u;event.getData().soft===this._softState||a?this._popover&&this._popover.open():this._popover&&this._popover.close()};v.prototype.isInitialized=function(){"use strict";var a=this.options.contentsSigil||"contents";return!!h.scry(this._jewelNode,"*",a)[0]};v.prototype._getJewelElement=function(){"use strict";return h.find(this._jewelNode,"div",this._sigil)};v.prototype._getCountElement=function(){"use strict";return h.find(this._getJewelElement(),"span","count")};v.prototype._getContentsElement=function(){"use strict";var a=this.options.contentsSigil||"contents";return h.find(this._getJewelElement(),"*",a)};v.prototype._getFlyoutElement=function(){"use strict";return h.find(this._getJewelElement(),"*","flyout")};v.prototype.getCount=function(){"use strict";return this._count};v.prototype.setDuringInit=function(a){"use strict";this._duringInit=a};v.prototype._updateCountElement=function(){"use strict";var a=this._getJewelCount();h.setContent(this._getCountElement(),s.formatNumberWithThousandDelimiters(a||0));a=this._getJewelElement();var b=this._count>0;g.conditionClass(a,"noCount",!b);g.conditionClass(a,"hasCount",b)};v.prototype.setCount=function(a){"use strict";if(a<0)return;this._count=a;this._updateCountElement()};v.prototype.setHeaderText=function(a,b){"use strict";__p&&__p();if(!a||!b)return;var c=this._getFlyoutElement();if(!c)return;c=h.scry(c,"*",a)[0];if(!c)return;a=c.cloneNode(!0);a.innerText=b;h.replace(c,a)};v.prototype.handleViewedContent=function(){"use strict";this.getCount()>0&&this.isInitialized()?(this.setCount(0),this.invoke("cleared")):this.invoke("jewel_click")};v.prototype.setMenuContent=function(a){"use strict";h.setContent(this._getFlyoutElement(),a),this.isOpen()&&this.handleViewedContent()};v.prototype.prependMenuContent=function(a){"use strict";h.prependContent(this._getContentsElement(),a)};v.prototype.removeMenuContent=function(a){"use strict";a=document.getElementById(a);a&&h.remove(a)};v.prototype.updateMenuColor=function(a,b,c){"use strict";c?t(this._updateMenuColor.bind(this,a,b),v.MARK_READ_DELAY):this._updateMenuColor(a,b)};v.prototype._updateMenuColor=function(a,b){"use strict";a=document.getElementById(a);a&&(g.conditionClass(a,v.M_AREA_LIGHTBLUE,!b),g.conditionClass(a,v.M_AREA_WHITE,b))};v.prototype._createPopover=function(){"use strict";var a=this._getJewelElement(),b=h.find(a,"div","flyout");this._popover=new n({button:h.find(a,"*","icon"),flyout:b,ensureVisible:!1,heightConstraint:!0,preventClose:!0,jewelRedirect:this.jewelRedirect});this._onOpenListener=this._popover.listen("open",this._onOpen.bind(this));this._onCloseListener=this._popover.listen("close",this._onClose.bind(this));this._popoverClickListener=h.listen(b,"click",null,this._onPopoverClick.bind(this));j.IS_ANDROID&&j.GET_OS_VERSION>=4&&(this._scrollAreaNode=h.scry(b,"div","scroll-area")[0])};v.prototype.clear=function(){"use strict";this._onOpenListener&&this._onOpenListener.remove(),this._onCloseListener&&this._onCloseListener.remove(),this._popoverClickListener&&this._popoverClickListener.remove(),this._popoverTouchStartListener&&this._popoverTouchStartListener.remove(),this._touchMoveListener&&this._touchMoveListener.remove(),this._touchStartListener&&this._touchStartListener.remove(),this._popover&&this._popover.clear()};v.prototype._onPopoverClick=function(event){"use strict";k.updateLink(event,this.options.pos),this.options.clickCallback&&this.options.clickCallback(event)};v.prototype._onPopoverTouchStart=function(event){"use strict";event.kill()};v.prototype._getJewelCount=function(){"use strict";if(this._count>0)return this._count;else return this._unreadCount};v.prototype._onOpen=function(){"use strict";__p&&__p();if(this._scrollAreaNode){m.scrollToHeader();var a=document.documentElement;g.conditionClass(a,"hide-scroll",!0);this._scrollAreaNode.style.maxHeight=a.offsetHeight-200+"px"}this._getJewelCount();i.pushSoftState(this._softState);this.handleViewedContent();o.invoke("m:jewel:flyout:open",null,{jewel:this._sigil});g.conditionClass(this._getJewelElement(),"popoverOpen",!0);a=h.find(this._getJewelElement(),"div","flyout");l.focusTabbable(a)};v.prototype._onClose=function(){"use strict";this._scrollAreaNode&&(this._scrollAreaNode.style.minHeight="",g.conditionClass(document.documentElement,"hide-scroll",!1)),o.invoke("m:jewel:flyout:close",null,{jewel:this._sigil}),g.conditionClass(this._getJewelElement(),"popoverOpen",!1),i.popSoftState(this._softState)};v.prototype.isOpen=function(){"use strict";return this._popover&&this._popover.isOpen()};v.prototype.openPopover=function(){"use strict";this._popover&&!this._popover.isOpen()&&this._popover.open()};v.prototype.reregisterListeners=function(){"use strict";var a=this.isOpen();this.clear();this._createPopover();a&&this._popover.open()};r(v,["cleared","jewel_click"]);Object.assign(v,{M_AREA_WHITE:"acw",M_AREA_LIGHTBLUE:"aclb",MARK_READ_DELAY:3e3,JEWEL_NAV_NODE_ID:"mJewelNav",nextID:0});Object.assign(v.prototype,{_sigil:null,_currentJewel:null,_count:0,_popover:null});e.exports=v}),null);
__d("FriendingSurfaceVisitationTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){h.log("logger:FriendingSurfaceVisitationLoggerConfig",this.$1,g.BASIC)};a.prototype.logVital=function(){h.log("logger:FriendingSurfaceVisitationLoggerConfig",this.$1,g.VITAL)};a.prototype.logImmediately=function(){h.log("logger:FriendingSurfaceVisitationLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setAppVersion=function(a){this.$1.app_version=a;return this};a.prototype.setBadgeCount=function(a){this.$1.badge_count=a;return this};a.prototype.setClientTimestamp=function(a){this.$1.client_timestamp=a;return this};a.prototype.setRawRefTab=function(a){this.$1.raw_ref_tab=a;return this};a.prototype.setRawTab=function(a){this.$1.raw_tab=a;return this};a.prototype.setRefPage=function(a){this.$1.ref_page=a;return this};a.prototype.setSurface=function(a){this.$1.surface=a;return this};a.prototype.setTargetProfileID=function(a){this.$1.target_profile_id=a;return this};a.prototype.setVC=function(a){this.$1.vc=a;return this};b={app_version:!0,badge_count:!0,client_timestamp:!0,raw_ref_tab:!0,raw_tab:!0,ref_page:!0,surface:!0,target_profile_id:!0,vc:!0};e.exports=a}),null);
__d("XFriendRequestIHEventLoggingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/requests/interaction_history_logging/",{target_id:{type:"FBID",required:!0},log_event:{type:"String",required:!0}})}),null);
__d("MFriendRequestIHEventLogger",["DOM","FBJSON","MRequest","XFriendRequestIHEventLoggingController"],(function(a,b,c,d,e,f,g,h,i,j){__p&&__p();a={listenToProfileClick:function(a,b,c){a=h.parse(a.getAttribute("data-store"));var d=a.userid?a.userid.toString():null;g.listen(c,"click",null,function(){this.logClick(d)}.bind(this));g.listen(b,"click",null,function(){this.logClick(d)}.bind(this))},logImpression:function(a){a&&this._logEvent(a,"impression")},logClick:function(a){a&&this._logEvent(a,"click")},_logEvent:function(a,event){if(isNaN(a))return;a=j.getURIBuilder().setFBID("target_id",a).setString("log_event",event).getURI();new i(a).send()}};e.exports=a}),null);
__d("MJewels",[],(function(a,b,c,d,e,f){e.exports={REQUESTS:"requests",MESSAGES:"messages",NOTIFICATIONS:"notifications",SEARCH:"search",MORE:"more",NEWS_FEED:"news-feed",BOOKMARKS:"bookmarks",VIDEOS:"videos",CASUAL_GROUPS:"casual_groups",MARKETPLACE:"marketplace"}}),null);
__d("XCasualGroupsJewelTabActivityController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/mobile/casual_groups/jewel/update_activity/",{})}),null);
__d("XFBConfirmationCliffTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){h.log("logger:XFBConfirmationCliffLoggerConfig",this.$1,g.BASIC)};a.prototype.logVital=function(){h.log("logger:XFBConfirmationCliffLoggerConfig",this.$1,g.VITAL)};a.prototype.logImmediately=function(){h.log("logger:XFBConfirmationCliffLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setCliffCaller=function(a){this.$1.cliff_caller=a;return this};a.prototype.setError=function(a){this.$1.error=a;return this};a.prototype.setSurface=function(a){this.$1.surface=a;return this};a.prototype.updateExtraData=function(a){a=i(h.serializeMap(a));h.checkExtraDataFieldNames(a,j);this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.addToExtraData=function(a,b){var c={};c[a]=b;return this.updateExtraData(c)};var j={cliff_caller:!0,error:!0,surface:!0};e.exports=a}),null);
__d("XMessagesJewelContentController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/mobile/messages/jewel/content/",{spinner_id:{type:"String",required:!0}})}),null);
__d("XNotificationJewelContentController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/mobile/notifications/jewel/content/",{spinner_id:{type:"String",required:!0}})}),null);
__d("MJewelSet",["ChannelEventType","DOM","EventListener","FriendingSurfaceVisitationTypedLogger","MarauderLogger","MessagingEvent","MFriendRequestIHEventLogger","MInitJewelCounts","MJewel","MJewels","MLegacyDataStore","MLogState","MMessagesThreadRowID","MPymkFunnelLogger","MRequest","MTouchChannelManager","MURI","MViewport","Popover","ScriptPath","Stratcom","XCasualGroupsJewelTabActivityController","XFBConfirmationCliffTypedLogger","XMessagesJewelContentController","XNotificationJewelContentController","fbt","gkx","throttle"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H){__p&&__p();var I={_viewerID:null,_requestsJewel:null,_messagesJewel:null,_notificationsJewel:null,_unseenNotificationIds:{},_unseenThreadIDs:{},_unreadThreadIDs:{},_jewelClickLogListener:null,_messengerCliff:!1,_haveInitializedJewels:!1,_pymkAndRequestImpressionLogged:!1,MSG_ID_PREFIX:"msg_",NOTIF_ID_PREFIX:"notif_",JEWEL_NAV_NODE_ID:"mJewelNav",JEWEL_NAV_CACHE_KEY:"mJewelNavKey",JEWEL_MSG_LIST:"mJewelMsgThreadContents",_lazyLoadNotificationsReq:null,_lazyLoadMessagesReq:null,createJewels:function(a){a.showRequests&&(I._requestsJewel=new o("requests",{pos:r.CLICK_POSITION_REQUESTS_FLYOUT,softState:p.REQUESTS,jewelRedirect:a.shouldRedirectRequestsJewel},"friends_jewel_module"),I._requestsJewel.listen("cleared",I._markRequestsRead),I._requestsJewel.listen("jewel_click",I._logRequestsJewelClick)),a.showCasualGroups&&(I._casualGroupsJewel=new o("casual_groups",{softState:p.CASUAL_GROUPS},"casual_groups_jewel_module"),I._casualGroupsJewel.listen("jewel_click",I._updateCasualGroupsTabActivity)),I._messagesJewel=new o("messages",{contentsSigil:I.JEWEL_MSG_LIST,pos:r.CLICK_POSITION_MESSAGES_FLYOUT,softState:p.MESSAGES},"messages_jewel_module"),I._messagesJewel.listen("cleared",I._markMessagesRead),I._notificationsJewel=new o("notifications",{pos:r.CLICK_POSITION_NOTIFICATIONS_FLYOUT,softState:p.NOTIFICATIONS},"notifications_jewel_module"),I._notificationsJewel.listen("cleared",I._markNotificationsSeen),I._jewelClickLogListener=I._notificationsJewel.listen("jewel_click",I._logNotificationJewelClick),A.listen("m:jewel:flyout:open",null,I._onJewelOpen)},openMessageJewel:function(){I._messagesJewel.openPopover()},setMessengerCliff:function(a,b,c){I._messengerCliff=a},setMessengerCliffShouldLog:function(a,b){},markFriendRequestsSeen:function(event){if(I._requestsJewel===null)return;I._requestsJewel.setCount(0)},updateFriendRequests:function(event){if(I._requestsJewel===null)return;if(I._requestsJewel.isOpen())return;I._loadRequestsJewel()},onAfterUpdateFriendRequests:function(a){if(I._requestsJewel===null)return;I._setJewelCount(I._requestsJewel,a,I._markRequestsRead);y.getInstance("reqs_flyout").refreshConstraints();if(I._requestsJewel.isOpen()){a=I._requestsJewel._getContentsElement();I._logPymkAndRequestImpression(a)}},onAfterLoadMoreFriendSuggestions:function(){if(I._requestsJewel===null)return;y.getInstance("reqs_flyout").refreshConstraints()},_logPymkAndRequestImpression:function(a){__p&&__p();if(I._pymkAndRequestImpressionLogged)return;I._pymkAndRequestImpressionLogged=!0;a=h.scry(a,"div","undoable-action");for(var b=0;b<a.length;b++){var c=a[b].getAttribute("data-pymk-id");if(c){var d=a[b].getAttribute("data-signature");t.logImpression(c,d,"mobile_jewel")}else{c=q.get(a[b]).userid;k.log("request_seen","friend_request_waterfall",{request_id:c,request_location:"requests_jewel"});m.logImpression(c?c.toString():null)}}},refreshNotificationsConstraints:function(){y.getInstance("notifications_flyout").refreshConstraints()},refreshNotificationsConstraintsOnImageLoad:function(){var a=document.getElementById("notifications_flyout");if(!a)return;I.refreshNotificationsConstraints();var b=H(I.refreshNotificationsConstraints,500);h.scry(a,"img","notif_thumb").forEach(function(a){var c=i.listen(a,"load",function(){c.remove(),b()})})},refreshMessagesConstraints:function(){y.getInstance("messages_flyout").refreshConstraints()},updateNotification:function(event){__p&&__p();var a=event.getData();if(a&&a.data){if(a.data.type==="friend_confirmed")return;!I._notificationsJewel.isOpen()&&!I._unseenNotificationIds[a.data.alert_id]&&I._notificationsJewel.setCount(a.data.unread+I._notificationsJewel.getCount());I._notificationsJewel.removeMenuContent(I._getNotifNodeID(a.data.alert_id));I._unseenNotificationIds[a.data.alert_id]=!0;I._notificationsJewel.isOpen()&&I._markNotificationsSeen();I._loadNotificationJewelContent()}},updateUnseenNotificationIds:function(event){__p&&__p();var a=event.getData();if(!a)return;var b=event.getType()=="notifications_read";if(a.alert_ids){var c=0;for(var d=0;d<a.alert_ids.length;d++)I._unseenNotificationIds[a.alert_ids[d]]&&(delete I._unseenNotificationIds[a.alert_ids[d]],b&&I._notificationsJewel.updateMenuColor(I._getNotifNodeID(a.alert_ids[d]),!0,!1),c++);d=I._notificationsJewel.getCount();I._notificationsJewel.setCount(d-c)}else{I._notificationsJewel.setCount(0);if(b)for(var e in I._unseenNotificationIds)I._notificationsJewel.updateMenuColor(I._getNotifNodeID(e),!0,!1);I._unseenNotificationIds={}}},updateMessageCounts:function(event){__p&&__p();var a=event.getData();if(!a)return;if(a.event===l.READ&&a.message.folder==="inbox"){var b=a.message.thread_fbid||a.message.other_user_fbid;delete I._unseenThreadIDs[b];delete I._unreadThreadIDs[b]}else if(a.event===l.UNREAD&&a.message.folder==="inbox"){b=a.message.thread_fbid||a.message.other_user_fbid;I._unreadThreadIDs[b]=1}else if(a.event===l.MARK_ALL_READ&&a.message.folder==="inbox")I._unreadThreadIDs={},I._unseenThreadIDs={};else if(a.event===l.MARK_ALL_SEEN&&a.message.folder==="inbox")I._unseenThreadIDs={};else if(a.parsedPayload&&a.folder==="inbox"){b=a.parsedPayload;if(!I._viewerIsAParticipant(I._viewerID,b)||b.isUnread()===!1||a.message.is_muted)return;a=b.getThreadFBID()||b.getOtherUserFBID();I._unseenThreadIDs[a]=1;I._unreadThreadIDs[a]=1}else return;b=Object.keys(I._unseenThreadIDs).length;a=Object.keys(I._unreadThreadIDs).length;!I._messagesJewel.isOpen()&&b!==I._messagesJewel.getCount()&&I._messagesJewel.setCount(b);b=a>0?F._("Messages ({unread_message_count})",[F._param("unread_message_count",a)]):F._("Messages");I._messagesJewel.setHeaderText("messages_jewel_header_text",b)},updateMessage:function(event){__p&&__p();var a=event.getData();if(!a)return;if(a.parsedPayload){var b=a.parsedPayload;if(b.getFolder()!=="inbox"||!I._viewerIsAParticipant(I._viewerID,b))return;I._messagesJewel.isInitialized()&&(I._messagesJewel.removeMenuContent(I._getMessageNodeID(b.getOtherUserFBID(),b.getThreadFBID())),I._messagesJewel.isOpen()&&I._markMessagesRead());I._loadMessagesJewelContent()}else a.event===l.READ&&a.is_sync&&I._messagesJewel.updateMenuColor(I._getMessageNodeID(a.message.other_user_fbid,a.message.thread_fbid),!0,!1)},_getMessageNodeID:function(a,b){return s.getThreadRowID(I.MSG_ID_PREFIX,a,b)},_getNotifNodeID:function(a){return I.NOTIF_ID_PREFIX+a},_markRequestsRead:function(){A.invoke("m_requests_jewel_mark_read");var a=new u(new w("/a/jewel_requests_read.php").toString());a.send()},_markMessagesRead:function(){var a=new u(new w("/a/jewel_messages_read.php").toString());a.send()},_markNotificationsSeen:function(){I._jewelClickLogListener&&(I._jewelClickLogListener.remove(),I._jewelClickLogListener=null);var a=I._unseenNotificationIds;I._unseenNotificationIds={};var b=[];for(var c in a)b.push(c);a=new u(new w("/a/jewel_notifications_read.php").toString());a.addData({ids:b,count:b.length,seen:!0});a.send()},_onJewelOpen:function(event){__p&&__p();var a=event.getData();if(a&&a.jewel)if(a.jewel==="notifications")I._loadNotificationJewelContent();else if(a.jewel==="messages"){I._messengerCliff&&new C().setSurface("messenger_seen").log();var b=I._messagesJewel.getCount();I._messagesJewel.setCount(b);I._loadMessagesJewelContent()}z.set("topbar_"+a.jewel)},_loadNotificationJewelContent:function(){var a=I._notificationsJewel._getContentsElement(),b="notifications-flyout-loading";if(A.hasSigil(a,b)){b=E.getURIBuilder().setString("spinner_id",a.getAttribute("id")).getURI();I._lazyLoadNotificationsReq||(I._lazyLoadNotificationsReq=new u(b),I._lazyLoadNotificationsReq.listen("finally",function(){I._lazyLoadNotificationsReq=null}),I._lazyLoadNotificationsReq.send())}},_loadMessagesJewelContent:function(){var a=I._messagesJewel._getJewelElement(),b="messages-flyout-loading";a=h.scry(a,"*",b);if(a.length>0){b=D.getURIBuilder().setString("spinner_id",a[0].getAttribute("id")).getURI();I._lazyLoadMessagesReq||(I._lazyLoadMessagesReq=new u(b),I._lazyLoadMessagesReq.listen("finally",function(){I._lazyLoadMessagesReq=null}),I._lazyLoadMessagesReq.send())}},_logNotificationJewelClick:function(){I._jewelClickLogListener&&(I._jewelClickLogListener.remove(),I._jewelClickLogListener=null),new u("/a/jewel_notifications_log.php").addData({click_type:"jewel_click",count:I._notificationsJewel.getCount()}).send()},_updateCasualGroupsTabActivity:function(){var a=B.getURIBuilder().getURI();I._updateCasualGroupsTabActivityReq||(I._updateCasualGroupsTabActivityReq=new u(a),I._updateCasualGroupsTabActivityReq.listen("finally",function(){I._updateCasualGroupsTabActivityReq=null}),I._updateCasualGroupsTabActivityReq.send());I._casualGroupsJewel.setCount(0)},_logRequestsJewelClick:function(){var a=I._requestsJewel._getContentsElement();I._logRequestsImpessions(a);new j().setSurface("jewel").setBadgeCount(I._requestsJewel.getCount()).log();I.lazyLoadRequestsJewelIfTabOpen()},_logRequestsImpessions:function(a){__p&&__p();if(!a)return;a=h.scry(a,"div","attachment");var b=[];for(var c=0;c<a.length;c++){var d=a[c].getAttribute("id");d&&d.startsWith("m_jewel_req_")&&(b=b.concat(d.replace("m_jewel_req_","")))}if(b.length){d=new u("/friends/requests/log_impressions");d.setMethod("POST");d.addData({ids:b.join(","),ref:"m_jewel"});d.send()}},_viewerIsAParticipant:function(a,b){if(!b.getParticipantIDs())return!1;return b.getParticipantIDs().indexOf(a)>-1?!0:b.getParticipantIDs().indexOf(a.toString())>-1},_initJewelCount:function(a,b,c){a.setDuringInit(!0),a.reregisterListeners(),I._setJewelCount(a,b,c),a.setDuringInit(!1)},_setJewelCount:function(a,b,c){!a.isOpen()?a.setCount(b):b&&c()},_initJewelCounts:function(event){__p&&__p();var a=event.getData();I.initJewels(null,null);a.viewer_id&&(I._viewerID=a.viewer_id);a.unread_notification_ids&&(I._unseenNotificationIds=a.unread_notification_ids||{});a.unseen_thread_ids&&(I._unseenThreadIDs=a.unseen_thread_ids.reduce(function(a,b){a[b]=1;return a},{}));a.unread_thread_ids&&(I._unreadThreadIDs=a.unread_thread_ids.reduce(function(a,b){a[b]=1;return a},{}));a.request_count&&I._requestsJewel&&I._initJewelCount(I._requestsJewel,a.request_count,I._markRequestsRead);if(a.unseen_thread_ids){var b=a.unseen_thread_ids?a.unseen_thread_ids.length:0;b=b;I._initJewelCount(I._messagesJewel,b,I._markMessagesRead)}a.notification_count&&I._initJewelCount(I._notificationsJewel,a.notification_count,I._markNotificationsSeen)},lazyLoadRequestsJewelIfTabOpen:function(){__p&&__p();if(I._requestsJewel&&I._requestsJewel.isOpen()){var a=I._requestsJewel._getContentsElement();if(A.hasSigil(a,"requests-flyout-pagelet-placeholder"))return;if(A.hasSigil(a,"requests-flyout-loading"))I._loadRequestsJewel();else{a=I._requestsJewel._getContentsElement();I._logPymkAndRequestImpression(a)}}},_loadRequestsJewel:function(){new u("/ajax/mobile/friends/jewel/requests_markup").send()},initJewels:function(a,b){__p&&__p();if(I._haveInitializedJewels&&(!b||!G("AT5J2eFdLcTezMMRuE1M2NArKONL3RlguQ3m5VpzRWaCJmORt3i3mxTzCtS25Y1Rb4viPrwXLvzxr8xWpv6prWj_")))return;I._haveInitializedJewels=!0;v.initialize();I.createJewels(b||{});I._requestsJewel&&(I._friendRequestAddListener||(I._friendRequestAddListener=A.listen("jewel_requests_add",null,I.updateFriendRequests)),I._friendRequestRemoveListener||(I._friendRequestRemoveListener=A.listen("jewel_requests_remove_old",null,I.updateFriendRequests)),I._friendAcceptedListener||(I._friendAcceptedListener=A.listen("jewel_friending_notifs",null,I.updateFriendRequests)),I._friendRequestSeenListener||(I._friendRequestSeenListener=A.listen("friend_requests_seen",null,I.markFriendRequestsSeen)));I._notificationListener||(I._notificationListener=A.listen("m_notification",null,I.updateNotification));I._notificationRefreshListener||(I._notificationRefreshListener=A.listen("m:jewel-set:notifications-jewel:refresh-flyout",null,I.refreshNotificationsConstraints));I._messageListener||(I._messageListener=A.listen(g.MESSAGE,null,I.updateMessage));I._messageCountListener||(I._messageCountListener=A.listen(g.MESSAGE,null,I.updateMessageCounts));I._notifReadListener||(I._notifReadListener=A.listen("notifications_read",null,I.updateUnseenNotificationIds));I._notifSeenListener||(I._notifSeenListener=A.listen("notifications_seen",null,I.updateUnseenNotificationIds));I._friendRequestResponseListener||(I._friendRequestResponseListener=A.listen("m:requests:refresh",null,function(){y.getInstance("reqs_flyout").refreshConstraints()}));I._orientationChangeListener||(I._orientationChangeListener=A.listen("m:viewport:orientation-change",null,I._onOrientationChange));G("AT491Oc_2Krj9j0bDofeAxIM5JRIaYnrKNrBhSXyZrNvW9W_A5Z4FPzT7ZMpZrrx4XDHZuOZxs_RQqRD-z_mTFyZA8zQirX8bJOg2qB2S_Z-tg")&&(A.listen("m:jewels:init-counts",null,I._initJewelCounts),n.replayMissedEvents())},_onOrientationChange:function(){setTimeout(function(){var a=y._activePopover;if(!a)return;x.getHeight()+"px"!==a.flyout.style.minHeight&&a.refreshConstraints()},800)}};(function(){G("AT491Oc_2Krj9j0bDofeAxIM5JRIaYnrKNrBhSXyZrNvW9W_A5Z4FPzT7ZMpZrrx4XDHZuOZxs_RQqRD-z_mTFyZA8zQirX8bJOg2qB2S_Z-tg")||(A.listen("m:jewels:init-counts",null,I._initJewelCounts),n.replayMissedEvents())})();e.exports=I}),null);
__d("MJewelNotifications",["Bootloader","ChannelEventType","MRequest","MURI","Run","Stratcom","SubscriptionsHandler","isFacebookURI"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){"use strict";__p&&__p();function a(a){this.$1=a,this.$2=[],this.$3=!1,this.$4=!1,this.$5=new m(),this.$5.addSubscriptions(k.onLeave(function(){this.$5.release()}.bind(this)),l.listen(h.NOTIFICATIONS_NEW,null,this.onNotificationReceive.bind(this)))}a.prototype.getNotifications=function(){return this.$2};a.prototype.registerListeners=function(){this.$5.addSubscriptions(l.listen(h.NOTIFICATIONS_READ,null,this.onNotificationRead.bind(this)),l.listen("click","live-notifications",this.onNotificationClick.bind(this)),l.listen("m:jewel:flyout:open",null,this.onJewelOpen.bind(this)))};a.prototype.onJewelOpen=function(event){var a=event.getData();a=a&&a.jewel&&a.jewel==="notifications";a&&this.$4&&this.updateUI()};a.prototype.onNotificationClick=function(event){var a=event.getNode("live-notification");if(!a)return;a=a.getAttribute("data-alertid");this.readNotification(a);this.updateUI();new i("/a/jewel_notifications_log.php").addData({click_type:"jewel_notif_click",id:a}).send()};a.prototype.onNotificationRead=function(event){var a=event.getData();a&&a.alert_ids&&(a.alert_ids.forEach(function(a){this.readNotification(a)}.bind(this)),this.updateUI())};a.prototype.readNotification=function(a){this.$2.forEach(function(b){b.alert_id==a&&(b.unread&&(this.$4=!0),b.unread=!1)}.bind(this))};a.prototype.addNotification=function(a){this.$2=this.$2.filter(function(b){return b.alert_id!==a.alert_id}),a.timestamp=Date.now(),this.$2.push(a),this.$4=!0};a.prototype.onNotificationReceive=function(event){var a=event.getData();if(a&&a.data){if(a.data.type==="friend_confirmed")return;this.$3||(this.$3=!0,this.registerListeners());this.addNotification(a.data);this.updateUI()}};a.prototype.updateUI=function(){if(!this.$3||!this.$4)return;g.loadModules(["React","ReactDOM","MJewelNotificationList.react","Popover"],function(a,b,c,d){if(!d.getInstance("notifications_flyout").isOpen())return;var e={notifications:this.$2};b.render(a.createElement(c,e),this.$1);d.getInstance("notifications_flyout").refreshConstraints();this.$4=!1}.bind(this),"MJewelNotifications")};e.exports=a}),null);
__d("MJewelThreads",["Bootloader","ChannelEventType","MessagingEvent","Stratcom"],(function(a,b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();function a(a){this.$1=a,this.$2=[],this.$3=!1,this.$4=!1,j.listen(h.MESSAGE,null,this.onMessageEvent.bind(this))}a.prototype.getThreads=function(){return this.$2};a.prototype.registerListeners=function(){j.listen("click","live-threads",this.onThreadClick.bind(this)),j.listen("m:jewel:flyout:open",null,this.onJewelOpen.bind(this))};a.prototype.onJewelOpen=function(event){var a=event.getData();a=a&&a.jewel&&a.jewel==="messages";a&&this.$4&&this.updateUI()};a.prototype.onThreadClick=function(event){var a=event.getNode("live-thread");if(!a)return;this.setThreadReadStatus(a.getAttribute("data-fbid"),a.getAttribute("data-canonical")==="true",!0);this.updateUI()};a.prototype.onMessageEvent=function(event){__p&&__p();var a=event.getData();if(a.parsedPayload){var b=a.parsedPayload;if(b.getFolder()!=="inbox")return;this.$3||(this.$3=!0,this.registerListeners());this.addThread(b)}else if(Object.prototype.hasOwnProperty.call(a,"mark_as_read"))a.other_user_fbids.forEach(function(b){this.setThreadReadStatus(b.toString(),!0,a.mark_as_read)}.bind(this)),a.thread_fbids.forEach(function(b){this.setThreadReadStatus(b.toString(),!1,a.mark_as_read)}.bind(this)),this.updateUI();else if(a.event===i.READ&&a.is_sync){b=!!a.message.other_user_fbid;var c=b?a.message.other_user_fbid:a.message.thread_fbid;this.setThreadReadStatus(c,b,!0);this.updateUI()}};a.prototype.addThread=function(a){this.$2=this.$2.filter(function(b){b=b.isCanonicalThread()?b.getOtherUserFBID():b.getThreadFBID();return!this.isSameThread(b,a.isCanonicalThread(),a)}.bind(this)),a.unread=a.isUnread(),this.$2.push(a),this.$4=!0,this.updateThreadImage(a)};a.prototype.updateThreadImage=function(a){g.loadModules(["MMessagesThreadMetadataCache","MShortProfiles"],function(b,c){if(a.hasThreadImage())b.get(a.getThreadFBID(),function(b){a.image_src=b.image_src,this.updateUI()}.bind(this));else{b=a.isCanonicalThread()?a.getOtherUserFBID():a.getAuthorFBID();c.get(b,function(b){a.image_src=b.mThumbSrcSmall,this.updateUI()}.bind(this))}}.bind(this),"MJewelThreads")};a.prototype.setThreadReadStatus=function(a,b,c){this.$2.forEach(function(d){this.isSameThread(a,b,d)&&(d.unread==c&&(this.$4=!0),d.unread=!c)}.bind(this))};a.prototype.isSameThread=function(a,b,c){b=b?c.getOtherUserFBID():c.getThreadFBID();return a==b};a.prototype.updateUI=function(){if(!this.$3||!this.$4)return;g.loadModules(["React","ReactDOM","MJewelThreadList.react","Popover"],function(a,b,c,d){if(!d.getInstance("messages_flyout").isOpen())return;var e={threads:this.$2};b.render(a.createElement(c,e),this.$1);d.getInstance("messages_flyout").refreshConstraints();this.$4=!1}.bind(this),"MJewelThreads")};e.exports=a}),null);
__d("MRequestsJewelTitleBadge",["CSS","ge","DOM","Stratcom","DataStore"],(function(a,b,c,d,e,f,g,h,i,j,k){__p&&__p();var l="friends-center-request-item";a={friendingListener:null,init:function(){var a=h("m-jewel-requests-title-badge");if(a){var b=parseInt(k.get(a,"count"),10);b<=0&&g.hide(a)}a=h("m-friend-center-requests-title-badge");a&&(b=parseInt(k.get(a,"count"),10),b<=0&&g.hide(a));this.friendingListener||(this.friendingListener=j.listen("m:optimistic-request-response:click",l,this.decrementBadgeCounts))},updateAfterNewReqs:function(a){var b=h("m-jewel-requests-title-badge");b&&a>0&&(k.set(b,"count",a),g.show(b),i.setContent(b,a))},decrementBadgeCounts:function(a){a=h("m-jewel-requests-title-badge");if(a){var b=parseInt(k.get(a,"count"),10);b=Math.max(b,0)-1;k.set(a,"count",b);b>0?(g.show(a),i.setContent(a,b)):g.hide(a)}a=h("m-friend-center-requests-title-badge");a&&(b=parseInt(k.get(a,"count"),10),b=Math.max(b,0)-1,k.set(a,"count",b),b>0?(g.show(a),i.setContent(a,b)):g.hide(a))}};e.exports=a}),null);
__d("MSideNavMarauderLogger",["MLegacyDataStore","Stratcom","MarauderLogger","MTouchClick"],(function(a,b,c,d,e,f,g,h,i,j){__p&&__p();var k="";function a(event){i.toggleModule("sidebar_menu",!0)}function b(event){i.toggleModule("sidebar_menu",!1)}function c(event){var a=event.getNode("tag:a"),b=event.getNode("tag:div");i.log("open_application","sidebar_menu",{application_link_type:"local_module",display_name:b?b.innerText:"unknown",url:a&&a.href});i.setNavigationModule("sidebar_menu")}function d(){o("session_start")}function f(){o("cancel")}function l(a){__p&&__p();a=a.getData();if(a.node.rel<=0)return;var b=0,c="",d=g.get(a.node);d&&(b=d.bootstrap?1:0,c=d.type);d=0;var e=null;for(var f=0;f<a.results.length;f++){var h=a.results[f];if(h.rel>0){if(h.rel==a.node.rel){e=d;break}d++}}o("click",{query:a.query,is_bootstrapped:b,display_position:e},c,a.node.rel)}function m(a){a=a.getData();o("click",{query:a.query,is_bootstrapped:a.node.bootstrap?1:0,display_position:a.position},a.node.type,a.node.id)}function n(a){k!==a&&o("search_keystroke",{prev_query:k,new_query:a}),k=a}function o(a,b,c,d){i.log(a,"search_typeahead",b,c,d)}function p(a){return a.listen("change",n)}h.listen("m:side-area:show",null,a);h.listen("m:side-area:hide",null,b);h.listen("click","side-menu-item",c);a=j.hasTouchEvents()?"touchend":"click";h.listen(a,"search-activator",d);h.listen(a,"graph-search-activator",d);h.listen("click","graph-search-entry-point",d);h.listen("m:search-overlay:cancel",null,f);h.listen("m:search-overlay:cancel-react",null,f);h.listen("m:search-typeahead:select",null,l);h.listen("m:search-typeahead:select-react",null,m);e.exports={setupTypeaheadListener:p}}),null);
__d("MNotificationClick",["CSS","MLegacyDataStore","MRequest","Stratcom"],(function(a,b,c,d,e,f,g,h,i,j){__p&&__p();var k="notification",l="list_",m="acw",n="aclb",o={},p=!1;e.exports={init:function(){if(p)return;j.listen("click",k,q);j.listen("m:page:render:cache:complete",null,r);p=!0}};function q(event){var a=event.getNode("touchable");if(!a)return;var b=h.get(a).notif_id;if(!b)return;new i("/a/jewel_notifications_log.php").addData({click_type:"notification_click",id:b,target_id:h.get(a).target_id}).send();s(event)}function r(a){if(a.getData().path.indexOf("notifications")>-1)for(var b in o)t(b)}function s(event){__p&&__p();var a=event.getNode("marea");if(!a)return;a=a.getAttribute("id");if(!a)return;t(a);var b=a.startsWith(l)?a.substring(l.length):l+a;t(b);o[a]=!0;o[b]=!0}function t(a){a=document.getElementById(a);a&&(g.addClass(a,m),g.removeClass(a,n))}}),null);
__d("XQuickPromotionSimpleLoggingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/qp/action/log/",{qp_id:{type:"Int",required:!0},qp_action:{type:"Enum",enumType:1},qp_instance_log_data:{type:"StringToStringMap",defaultValue:{}},qp_event:{type:"String"}})}),null);
__d("MQuickPromotionEmbeddedInterstitial",["DOM","MRequest","Stratcom","XQuickPromotionSimpleLoggingController"],(function(a,b,c,d,e,f,g,h,i,j){__p&&__p();var k=!1;a=function(a,b,c){__p&&__p();if(k)return;k=!0;function d(event){i.removeCurrentListener();var b=event.getNode(a.promo);g.hide(b);b=g.find(event.getNode(a.jewel),"div",a.sibling);g.show(b);i.invoke("m:qp:embedded-interstitial:close")}function e(event){if(event.getData().jewel==a.jewel){i.removeCurrentListener();var d=j.getURIBuilder().setInt("qp_id",b).setStringToStringMap("qp_instance_log_data",c).setString("qp_event","view").getURI();d=new h(d);d.send()}}i.listen("click",a.close,d);i.listen("m:jewel:flyout:open",null,e)};f.main=a}),null);
__d("MActionBubbleMask",["CSS","DOM","MViewport","Stratcom","cx","requestAnimationFrame"],(function(a,b,c,d,e,f,g,h,i,j,k,l){__p&&__p();var m="_5nvw",n="_5nvx",o=300;function a(a){"use strict";this.$1=null,this.$2=null,this.$3=a}a.prototype.enable=function(){"use strict";var a=this.$3.getRoot().getAttribute("data-mask-class");a||(a=m);this.$2=h.create("div",{className:a});this.$1=[this.$3.addListener("show",this.$4.bind(this)),this.$3.addListener("hide",this.$5.bind(this)),this.$3.addListener("reposition",this.$6.bind(this)),h.listen(this.$2,"touchend",null,function(a){a.stop()})];this.$3.isShown()&&this.$4()};a.prototype.disable=function(){"use strict";this.$5();while(this.$1.length)this.$1.pop().remove();this.$1=null;this.$2=null};a.prototype.$4=function(){"use strict";h.insertBefore(this.$3.getRoot(),this.$2),g.addClass(this.$3.getCausalElement(),n),this.$7=j.listen("scroll",null,this.$6.bind(this)),this.$6()};a.prototype.$5=function(){"use strict";h.remove(this.$2);var a=this.$3.getCausalElement();a&&g.removeClass(a,n);this.$7&&this.$7.remove();this.$7=null};a.prototype.$6=function(){"use strict";l(function(){this.$2.style.top=i.getScrollTop()-o+"px",this.$2.style.height=i.getHeight()+o*2+"px"}.bind(this))};e.exports=a}),null);
__d("MLayerHideOnCloseClick",["DOM"],(function(a,b,c,d,e,f,g){__p&&__p();function a(a){"use strict";this.$1=null,this.$2=null,this.$3=a}a.prototype.enable=function(){"use strict";this.$1=[this.$3.addListener("show",this.$4.bind(this)),this.$3.addListener("hide",this.$5.bind(this))],this.$3.isShown()&&this.$4()};a.prototype.disable=function(){"use strict";this.$5();while(this.$1.length)this.$1.pop().remove();this.$1=null};a.prototype.$5=function(){"use strict";this.$2&&this.$2.remove()};a.prototype.$4=function(){"use strict";this.$2=g.listen(this.$3.getRoot(),"click","mlayer-hide-on-click",this.$3.hide.bind(this.$3))};e.exports=a}),null);
__d("MSearchTabBar",["CSS","DOM","MActionBubbleMask","MFlyout","MLayerDestroyOnTransition","MLayerHideOnBlur","MLayerHideOnCloseClick","Stratcom","SubscriptionsHandler","containsNode","cx","throttle"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){"use strict";__p&&__p();function s(a,b){__p&&__p();var c=arguments.length<=2||arguments[2]===undefined?{destroyOnTransition:!0}:arguments[2];this.render=function(){__p&&__p();this.$3==null&&(this.$3=h.create("div",{className:"button touchable _x02 _x03"},h.create("div",{className:"_x04"})),this.$9.addSubscriptions(h.listen(this.$3,"click",null,this.$12)),h.appendContent(this.$1,this.$3));this.$4==null&&(this.$4=h.create("div",{className:"_x08"}));if(this.$8==null){var a=[l,i,m];this.$10.destroyOnTransition&&a.push(k);this.$8=new j({classNames:["_55i2","accelerate"],nubalign:"center",offsetY:5,position:"below",margin:"none",width:"wide",addedBehaviors:a,context:this.$3},this.$4)}a=this.$5;if(a==null){a=[];for(var b=this.$2,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;a.push(h.create("a",{href:e.uri,className:"_x0a"+(e.is_selected===!0?" _x0b":""),"data-sigil":"mlayer-hide-on-click"},e.label))}h.prependContent(this.$1,a);this.$5=a}e=this.$6;e==null&&(e=this.$3.offsetWidth,this.$6=e);d=this.$1.offsetWidth-e;c=0;b=0;e=a.length;var f=void 0;for(;b<a.length;b++)this.$2[b].is_selected&&(f=b),this.$7[b]==null&&(this.$7[b]=a[b].offsetWidth),c+=this.$7[b],e===a.length&&c>d&&(e=b);b=a.slice();if(e<b.length&&f!=null&&f>=e){c=b[f];b.splice(f,1);b.splice(e-1,0,c)}for(var d=0;d<b.length;d++)d<e?h.appendContent(this.$1,b[d]):h.appendContent(this.$4,b[d]);h.appendContent(this.$1,this.$3);e<b.length?g.removeClass(this.$3,"_x03"):g.addClass(this.$3,"_x03")}.bind(this);this.$12=function(event){if(!p(this.$3,event.getTarget()))return;g.addClass(this.$3,"_x0d");n.addSigil(this.$3,"selected");n.removeCurrentListener()}.bind(this);this.$11=function(){g.removeClass(this.$3,"_x0d"),n.removeSigil(this.$3,"selected"),n.listen("click",null,this.$12)}.bind(this);this.$1=a;this.$7=[];this.$10=c;this.$9=new o();this.$9.addSubscriptions(n.listen("m:flyout:close",null,this.$11),n.listen(["m:viewport:orientation-change","resize"],null,r(this.render,200)));c.destroyOnTransition&&this.$9.addSubscriptions(n.listen("m:page:unload",null,function(){this.$9.release()}.bind(this)));b!=null&&this.setTabs(b)}s.prototype.setTabs=function(a){this.$2=a;this.$5!=null&&this.$5.forEach(function(a){return h.remove(a)});this.$5=null;this.render();return this};s.init=function(a,b){var c=arguments.length<=2||arguments[2]===undefined?{destroyOnTransition:!0}:arguments[2];return new s(a,b,c)};e.exports=s}),null);
__d("XGroupSearchResultsController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/groups/search/",{groupID:{type:"Int"},query:{type:"String"},name:{type:"String"},cursor:{type:"String"},source:{type:"String"}})}),null);
__d("MSearchSimplificationUtils",["MHistory","URI","XGroupSearchResultsController"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=new RegExp("^/(search/top|graphsearch/str.+/keywords_(top|search))"),k=new RegExp("^/(search|graphsearch|groups/search)"),l=new RegExp("^/(groups/search)");function m(a){var b=g.getPath();b=new h(b).getPath();return b.match(a)!=null}var n={getKeywordSemantic:function(a){return"keywords_search("+a+")"},getKeywordURI:function(a){return new h("/search/top/").addQueryData("q",a)},getGroupSearchURI:function(a,b){return i.getURIBuilder().setInt("groupID",a).setString("query",b).getURI()},isSearchURI:function(a){return a.getPath().match(k)!=null},isTopTabURI:function(a){return a.getPath().match(j)!=null},isCurrentPathTopTabPath:function(){return m(j)},isCurrentPathSERPPath:function(){return m(k)},isCurrentPathScopedSearchPath:function(){return m(l)},isTypeaheadOpen:function(){return g.getParam(g.SOFT_STATE_KEY)==="search"},isTabOverlayOpen:function(){return g.getParam(g.SOFT_STATE_KEY)!=null},getQueryFromCurrentPath:function(){if(!n.isCurrentPathSERPPath())return null;var a=new h(g.getPath()),b=a.getQueryData();if(b.q!=null)return b.q;b=a.getPath();a=b.match(/\/graphsearch\/str\/([^\/]+)/);return a!=null?decodeURIComponent(a[1]).replace(/\+/g," "):null}};e.exports=n}),null);
__d("MSearchTabsAboveBEM",["DOM","MSearchSimplificationUtils","MSearchTabBar","Stratcom","SubscriptionsHandler","URI","csx","cx","fbt"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){"use strict";__p&&__p();function p(a){this.$10=function(){this.$12()}.bind(this),this.$9=function(){this.$12()}.bind(this),this.$11=function(){var a=h.isCurrentPathSERPPath();a||p.setTabs(this.$8())}.bind(this),this.$3=a}p.prototype.enable=function(){this.$1={isVisible:!1};this.$2=g.create("div",{className:"_1t4h"});var a=document.querySelector("._234-");a!=null?g.insertBefore(a,this.$2):g.appendContent(this.$3.getRoot(),this.$2);p.$7=i.init(this.$2,p.$6!=null?p.$6:this.$8(),{destroyOnTransition:!1});g.hide(this.$2);this.$4=new k();this.$4.addSubscriptions(j.listen("m:page:render:complete",null,this.$9),j.listen("m:history:change",null,this.$10),j.listen("m:page:unload",null,this.$11));this.$12()};p.prototype.disable=function(){this.$4.release(),g.remove(this.$2)};p.prototype.$12=function(){var a=h.isCurrentPathSERPPath(),b=h.isTypeaheadOpen(),c=h.isCurrentPathScopedSearchPath();this.$13({isVisible:a&&!b&&!c})};p.prototype.$13=function(a){var b=babelHelpers["extends"]({},this.$1);this.$1=babelHelpers["extends"]({},this.$1,a);b.isVisible!==this.$1.isVisible&&(this.$1.isVisible?(g.show(this.$2),p.$7.render()):g.hide(this.$2))};p.prototype.$8=function(){this.$5==null&&(this.$5=[{is_selected:!0,label:o._("All"),uri:new l("#")},{label:o._("Posts"),uri:new l("#")},{label:o._("People"),uri:new l("#")},{label:o._("Photos"),uri:new l("#")},{label:o._("Videos"),uri:new l("#")},{label:o._("Pages"),uri:new l("#")},{label:o._("Places"),uri:new l("#")},{label:o._("Groups"),uri:new l("#")},{label:o._("Apps"),uri:new l("#")},{label:o._("Events"),uri:new l("#")}]);return this.$5};p.setTabs=function(a){p.$6=a;var b=p.$7;b!=null&&b.setTabs(a)};e.exports=p}),null);
__d("MLink",["DOM","MLegacyDataStore","ErrorUtils","MLinkHack","FBLogger","MLynx","MPageCache","MPageController","Stratcom","URI"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){__p&&__p();var q="standalone"in window.navigator&&window.navigator.standalone,r=!1;function a(){__p&&__p();if(r)return;r=!0;g.listen(document.documentElement,"click",null,function(event){__p&&__p();if(event.getPrevented())return;i.applyWithGuard(function(){__p&&__p();var a=event.getNode("tag:a");if(!a)return;var b=event.getRawEvent();if(a.getAttribute("onclick")||(b.which||b.button)>=2)return;j.remove(a);b=a.getAttribute("href");var c=new p(b),d=c.getProtocol();if(d&&d!="http"&&d!="https")return;var e=c.getDomain(),f=b&&b.charAt(0);f=!f||/[\/#]/.test(f);var g=c.getPort()?[e,c.getPort()].join(":"):e;f||location.host===g;f=e&&!/\.facebook.com$/i.test(e);f&&!l.isShimmedLink(a)&&k("FIXME").mustfix("Loading an external URL without shimming: %s",b);g=a.getAttribute("target");if((g=="_blank"||f)&&q)return;if(g=="_blank")window.open(b,"_blank");else if(c.getPath().toLowerCase().indexOf("/dialog/oauth")>-1)return;else if(g||d&&d+":"!==location.protocol||o.hasSigil(a,"no_mpc")||f)window.location=b;else if(b)if(b.indexOf("#")===0){e=document.getElementById(b.substr(1));e&&e.scrollIntoView()}else{c=h.get(a);c.fromCache&&m.setScrollHistory(b,0);n.load(b,{replace:c.behavior==="replace-state",expiration:c.fromCache?n.HISTORY_EXPIRE_MS:null})}else{if(a.hasAttribute("data-sigil"))return;g="";d=event.getTarget();while(d&&d!=document.body)g=g+" <"+d.nodeName,d.id&&(g=g+" id="+d.id),d.className&&(g=g+" class="+d.className),g=g+" >",d=d.parentNode;k("FIXME").warn('handleClick: unknown link action: <a id="%s" class="%s" /> Path: %s',a.id,a.className,g);return}event.prevent()},null,[],null,"LinkController")})}f.setupListener=a}),null);
__d("MPopoverClose",["Popover"],(function(a,b,c,d,e,f,g){a=function(){g._activePopover&&g._activePopover.close()};f.main=a}),null);
__d("TokenizeUtil",["nullthrows"],(function(a,b,c,d,e,f,g){__p&&__p();var h=/[ ]+/g,i=/[^ ]+/g;f=new RegExp("[^ "+k()+"]+|"+a(),"g");var j=new RegExp(a(),"g");function k(){return".,+*?$|#{}()'\\^\\-\\[\\]\\\\\\/!@%\"~=<>_:;\u30fb\u3001\u3002\u3008-\u3011\u3014-\u301f\uff1a-\uff1f\uff01-\uff0f\uff3b-\uff40\uff5b-\uff65\u2e2e\u061f\u066a-\u066c\u061b\u060c\u060d\ufd3e\ufd3f\u1801\u0964\u104a\u104b\u2010-\u2027\u2030-\u205e\xa1-\xb1\xb4-\xb8\xba\xbb\xbf"}function a(){return"["+k()+"]"}var l={},m={a:"\u0430 \xe0 \xe1 \xe2 \xe3 \xe4 \xe5 \u0101",b:"\u0431",c:"\u0446 \xe7 \u010d",d:"\u0434 \xf0 \u010f \u0111",e:"\u044d \u0435 \xe8 \xe9 \xea \xeb \u011b \u0113",f:"\u0444",g:"\u0433 \u011f \u0123",h:"\u0445 \u0127",i:"\u0438 \xec \xed \xee \xef \u0131 \u012b",j:"\u0439",k:"\u043a \u0138 \u0137",l:"\u043b \u013e \u013a \u0140 \u0142 \u013c",m:"\u043c",n:"\u043d \xf1 \u0148 \u0149 \u014b \u0146",o:"\u043e \xf8 \xf6 \xf5 \xf4 \xf3 \xf2",p:"\u043f",r:"\u0440 \u0159 \u0155",s:"\u0441 \u015f \u0161 \u017f",t:"\u0442 \u0165 \u0167 \xfe",u:"\u0443 \u044e \xfc \xfb \xfa \xf9 \u016f \u016b",v:"\u0432",y:"\u044b \xff \xfd",z:"\u0437 \u017e",ae:"\xe6",oe:"\u0153",ts:"\u0446",ch:"\u0447",ij:"\u0133",sh:"\u0448",ss:"\xdf",ya:"\u044f"};for(var n in m){var o=m[n].split(" ");for(var p=0;p<o.length;p++)l[o[p]]=n}function b(a){return a.replace(j," ")}function q(a){a=a.toLowerCase();var b="",c;for(var d=a.length;d--;)c=a.charAt(d),b=(l[c]||c)+b;return b.replace(h," ")}function r(a){var b=arguments.length<=1||arguments[1]===undefined?i:arguments[1],c=[],d=b.exec(a);while(d)d=d[0],c.push(d),d=b.exec(a);return c}function c(a){var b=arguments.length<=1||arguments[1]===undefined?i:arguments[1],c={};return function(d,e){if(!Object.prototype.hasOwnProperty.call(c,d)){var f=q(d),g=a(f);c[d]={value:d,flatValue:f,tokens:r(g,b),isPrefixQuery:!!g&&g[g.length-1]!=" "}}e!=null&&e!==!1&&c[d].sortedTokens===undefined&&(c[d].sortedTokens=c[d].tokens.slice(),c[d].sortedTokens.sort(function(a,b){return b.length-a.length}));return c[d]}}var s=c(b),t=c(function(a){return a},f);function d(a,b,c){__p&&__p();var d=a=="query"||a=="query_punc",e=a=="query_punc"?t:s;b=e(b,a=="prefix");var f=a=="prefix"?g(b.sortedTokens):b.tokens,h=e(c).tokens,i={},j=b.isPrefixQuery&&d?f.length-1:null;e=function(b,c){for(var e=0;e<h.length;++e){var f=h[e];if(!i[e]&&(f==b||(d&&c===j||a=="prefix")&&f.indexOf(b)===0))return i[e]=!0}return!1};return Boolean(f.length&&f.every(e))}o={flatten:q,parse:s,parseIncludingPunctuations:t,getPunctuation:a,makeParse:c,isExactMatch:d.bind(null,"exact"),isQueryMatch:d.bind(null,"query"),isQueryMatchIncludingPunctuations:d.bind(null,"query_punc"),isPrefixMatch:d.bind(null,"prefix"),tokenize:r};e.exports=o}),null);